---
title: ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ä½¿ç”¨ RVM / Bundler
date: 2018-12-21 16:37 +0800
typora-root-url: ../.vuepress/public
typora-copy-images-to: ../.vuepress/public/assets/images/${filename}
tags: 
  - ç™½é“¶
  - è®¡ç®—æœº-å·¥å…·-åŒ…ç®¡ç†
---

ä½œä¸ºä¸€å iOS å·¥ç¨‹å¸ˆï¼Œcocoapods æ˜¯æˆ‘ä»¬æ‰€ä¸ä¼šé™Œç”Ÿçš„ã€‚ç„¶è€Œåœ¨æˆ‘ä»¬çš„æ—¥å¸¸å¼€å‘ä¸­ï¼Œç¼–å†™ cocoapods çš„ Ruby è¯­è¨€æˆ‘ä»¬å¯èƒ½ä¸ç”šäº†è§£ï¼Œæ›´ä¸è¦è¯´ Bundler ä»¥åŠ RVM äº†ã€‚å› æ­¤ï¼Œå½“æˆ‘ä»¬é‡åˆ°ä¸€äº› Ruby ç¯å¢ƒç›¸å…³çš„é—®é¢˜æ—¶ï¼Œå¯èƒ½å®Œå…¨ä¸çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆã€‚å¦‚æœæ°å¥½ä½ å¯¹è¿™ä¸¤ä¸ªå·¥å…·åšäº†ä»€ä¹ˆæ„Ÿåˆ°å¥½å¥‡ï¼Œé‚£ä¹ˆï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä¼šå°½é‡ç”±æµ…å…¥æ·±çš„å»è¯´æ˜ RVM / Bundler çš„åŸç†å’Œä½œç”¨ï¼Œå¸®åŠ©å¤§å®¶å¯¹ Ruby çš„ç¯å¢ƒç®¡ç†æœ‰ä¸€ä¸ªæ›´åŠ æ·±å…¥çš„ç†è§£ã€‚

<!--more-->

## TLDR

- ä½¿ç”¨ RVM æ¥å®‰è£… Ruby
- `gem install rubygems-bundler && gem regenerate_binstubs` å¯ä»¥è®©ä½ å…å»æ¯æ¬¡éƒ½è¦åœ¨ `pod install` ä¹‹å‰æ·»åŠ  `bundle exec` çš„ç—›è‹¦

## Ruby æµ‹è¯•

æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒmacOS æ˜¯è‡ªå¸¦ Ruby çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬æ‹¿åˆ°ä¸€å°æ–°çš„ MacBook Proï¼Œè¿›å…¥ç³»ç»Ÿï¼Œæ‰“å¼€ç»ˆç«¯æ‰§è¡Œ `whereis ruby`ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ° `/usr/bin/ruby` è¿™æ ·çš„ç»“æœã€‚

åœ¨ç›®å‰çš„ macOS 10.14 ç‰ˆæœ¬ä¸­ï¼Œç³»ç»Ÿè‡ªå¸¦çš„ Ruby ç‰ˆæœ¬ä¸º 2.3.7ã€‚

## ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨ RVMï¼Ÿ

åœ¨æ²¡æœ‰å®‰è£… RVM æˆ–è€… rbenv è¿™æ ·çš„å·¥å…·ä»¥å‰ï¼Œå¤§å®¶åœ¨æ‰§è¡Œ `gem install cococapods` è¿™ä¸€è¡Œå‘½ä»¤çš„æ—¶å€™ä¸€å®šä¼šé‡åˆ°è¿™æ ·çš„æŠ¥é”™ï¼š

```
You don't have write permissions for the /Library/Ruby/Gems/2.3.0 directory
```

ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„é”™è¯¯ï¼Ÿå› ä¸º gem ä½œä¸º Ruby é»˜è®¤çš„åŒ…ç®¡ç†å™¨ï¼Œä¼šå°†æ‰€æœ‰ä¸‹è½½çš„ gem å®‰è£…åœ¨æŸä¸ªç‰¹å®šçš„ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬æš‚ä¸”ç§°å‘¼è¿™ä¸ªç›®å½•ä¸º Gem Path ï¼Œå¯¹äºç³»ç»Ÿçš„ Ruby æ¥è¯´ï¼Œè¿™ä¸ªç›®å½•å°±æ˜¯ /Library/Ruby/Gems/2.3.0ï¼Œè¿™æ˜¯ä¸€ä¸ªéœ€è¦å¯ç”¨ `sudo` æ‰èƒ½å†™å…¥çš„ç›®å½•ã€‚è¿™ä¹Ÿå°±å¯¼è‡´æˆ‘ä»¬åœ¨æ¯æ¬¡ `gem install` çš„æ—¶å€™éƒ½éœ€è¦åœ¨å‘½ä»¤ä¹‹å‰å¢åŠ  `sudo` æ‰èƒ½è®©å‘½ä»¤æ­£ç¡®æ‰§è¡Œã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è®© Gem Path æŒ‡å‘ä¸€ä¸ªæˆ‘ä»¬æ‹¥æœ‰å†™æƒé™çš„ç›®å½•ã€‚æ¯”è¾ƒç®€å•ç›´æ¥çš„åŠæ³•å°±æ˜¯æˆ‘ä»¬åˆ©ç”¨ homebrew å»å®‰è£…ä¸€ä¸ªæ–°çš„ Rubyã€‚

ä¼¼ä¹å¾ˆå®Œç¾ï¼Œä½†æœ‰ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬å¦‚ä½•çº¦æŸå¤§å®¶æ‰€æœ‰äººéƒ½ä½¿ç”¨åŒæ ·ç‰ˆæœ¬çš„ Ruby å‘¢ï¼Ÿ

ç­”æ¡ˆæ˜¯ä½¿ç”¨ Ruby çš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ã€‚ä»¥ RVM ä¸ºä¾‹ï¼Œå½“ä½ å®‰è£… RVM ä»¥åï¼Œä½ åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œçš„æ¯ä¸€ä¸ª `cd` å‘½ä»¤å…¶å®éƒ½è¢« RVM æ‰€æ›¿æ¢äº†ã€‚RVM ä¼šåœ¨æ¯ä¸€æ¬¡åˆ‡æ¢ç›®å½•åæ£€æŸ¥å½“å‰ç›®å½•ä¸­æ˜¯å¦æœ‰ .ruby-version æ–‡ä»¶ï¼Œå¦‚æœæœ‰ï¼Œå°±æ£€æŸ¥å½“å‰ä½¿ç”¨çš„ Ruby æ˜¯å¦æ˜¯æ–‡ä»¶ä¸­æŒ‡å®šçš„ç‰ˆæœ¬ã€‚å¦‚æœä¸æ˜¯ï¼Œä»–ä¼šç»™å‡ºç±»ä¼¼ `Required ruby-x.x.x is not installed` è¿™æ ·çš„è­¦å‘Šã€‚

åœ¨æˆ‘å¸å·¥ç¨‹çš„æ—©æœŸé˜¶æ®µï¼Œæˆ‘ä»¬é™¤äº†ä½¿ç”¨ cocoapodsï¼Œè¿˜éœ€è¦ä½¿ç”¨ Ruby ç¼–å†™ä¸€äº›æ‰“åŒ…å’Œå‘å¸ƒçš„è„šæœ¬ï¼Œè€Œå½“æ—¶ç³»ç»Ÿæä¾›çš„ Ruby ç‰ˆæœ¬è¿˜æ¯”è¾ƒä½ï¼ˆ2.0.0ï¼‰ï¼Œå¼€å‘èµ·æ¥ä¸å¤ªæ–¹ä¾¿ï¼Œè€Œåˆ©ç”¨ RVM ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥æ–¹ä¾¿çš„å®‰è£…ä¸€ä¸ªæ–°ç‰ˆæœ¬çš„ Rubyï¼Œè¿˜å¯ä»¥åˆ©ç”¨ .ruby-version æ¥ä¿è¯å¤§å®¶å¯ä»¥ä½¿ç”¨ç›¸åŒç‰ˆæœ¬çš„ Rubyï¼ˆå°½ç®¡åªæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¼±çš„çº¦æŸï¼‰ã€‚

ç›¸ä¿¡åˆ°è¿™é‡Œï¼Œå¤§å®¶å·²ç»èƒ½å¤Ÿç†è§£ï¼Œåœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ä½¿ç”¨ RVM æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹ç¬¬äºŒä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆè¦ç”¨ Bundlerï¼Ÿ

## ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Bundlerï¼Ÿ

ä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæŠŠç›®å…‰è½¬å‘ gemï¼Œå›é¡¾ä¸€ä¸‹ gem è¯ç”Ÿæ—¶è¦è§£å†³çš„é—®é¢˜ã€‚

### gem æ‰€è¦è§£å†³çš„é—®é¢˜

åœ¨ Ruby ä¸­ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨å¦å¤–ä¸€ä¸ª Ruby æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œä½ éœ€è¦ä½¿ç”¨ `require` å…³é”®å­—æ¥åŠ è½½å¦å¤–ä¸€ä¸ª Ruby æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚`require` ä¼šåœ¨ Ruby é¢„è®¾çš„ `$LOAD_PATH` ä¸­å»æŸ¥æ‰¾å¯¹åº”çš„æ–‡ä»¶ã€‚ä½ å¯ä»¥é€šè¿‡æ‰§è¡Œ `ruby -e 'puts $LOAD_PATH'` æ¥çœ‹çœ‹å½“å‰ Ruby ä¸­çš„ `$LOAD_PATH` éƒ½æœ‰ä»€ä¹ˆå†…å®¹ã€‚

ä¾‹å¦‚å¦‚æœä½ å†™äº†ä¸€ä¸ªç®€å•çš„ Ruby è„šæœ¬ï¼š

```ruby
require 'foo'
```

å½“æ‰§è¡Œåˆ° `require 'foo'` è¿™ä¸€è¡Œæ—¶, Ruby å°±ä¼šåœ¨ `$LOAD_PATH` ä¸­å‡ºç°çš„æ‰€æœ‰ç›®å½•ä¸‹å»æŸ¥æ‰¾æ˜¯å¦æœ‰ä¸€ä¸ªå«åš foo.rb çš„æ–‡ä»¶ã€‚å¦‚æœæœ‰ï¼Œå°±å»åŠ è½½è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚å¦‚æœåœ¨æ‰€æœ‰çš„ `$LOAD_PATH` ä¸­éƒ½æ²¡æœ‰æ‰¾åˆ°è¿™æ ·çš„ä¸€ä¸ªæ–‡ä»¶ï¼ŒRuby è§£é‡Šå™¨å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å¼‚å¸¸é€šå¸¸é•¿è¿™ä¸ªæ ·å­ï¼š

```
LoadError - cannot load such file -- foo
```

åœ¨æ²¡æœ‰ gem ä»¥å‰ï¼Œå¦‚æœä½ æƒ³ç”¨åˆ«äººå·²ç»å†™å¥½çš„ Ruby è„šæœ¬ï¼Œå°±éœ€è¦æ‰‹åŠ¨æŠŠè¿™äº›è„šæœ¬ä¸‹è½½ä¸‹æ¥ï¼Œæ”¾åˆ° `$LOAD_PATH` ä¸­çš„æŸä¸ªç›®å½•ä¸‹ï¼Œç„¶åä½ æ‰èƒ½åœ¨ä½ çš„è„šæœ¬ä¸­æ­£ç¡®çš„ä½¿ç”¨åˆ«äººçš„è„šæœ¬æ–‡ä»¶ã€‚è¿™æ ·çš„ä»£ç åˆ†å‘è¿‡ç¨‹æ˜¯éå¸¸åŸå§‹è€Œç¹ççš„ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œgem æ¨ªç©ºå‡ºä¸–ï¼Œæä¾›äº†è¿™æ ·çš„ä¸€ä¸ªè„šæœ¬åˆ†å‘è§£å†³æ–¹æ¡ˆï¼š

1. é¦–å…ˆç”¨ gemspec æ¥æè¿°ä½ å³å°†åˆ†å‘çš„è„šæœ¬çš„å…ƒä¿¡æ¯
2. åˆ©ç”¨ gem æä¾›çš„å‘½ä»¤ï¼Œå°†è„šæœ¬æ‰“åŒ…æˆä¸€ä¸ª .gem æ–‡ä»¶ï¼ˆ.gem å®è´¨å°±æ˜¯ä¸€ä¸ª POSIX tar archiveï¼‰ï¼Œç„¶åä¸Šä¼ åˆ°æœåŠ¡å™¨
3. å½“æœ‰å…¶ä»–äººæƒ³è¦ä½¿ç”¨ä½ çš„è„šæœ¬æ—¶ï¼Œæ‰§è¡Œ `gem install` å³å¯

å‰é¢çš„å†…å®¹å¾ˆå¥½ç†è§£ï¼Œæˆ‘ä»¬æ¥ç€é‡çœ‹ä¸€ä¸‹æ‰§è¡Œ `gem install` ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆã€‚

`gem install` æ‰€åšçš„äº‹æƒ…å…¶å®å¾ˆç®€å•ã€‚ä½†åˆ°æ­¤æ—¶ gem è¿˜æ²¡æœ‰å®Œå…¨è§£å†³æˆ‘ä»¬çš„é—®é¢˜ï¼š`gem install` æ‰€å®‰è£…çš„é‚£äº› gem å¹¶ä¸å­˜åœ¨äº `$LAOD_PATH` ä¸­ï¼Œæˆ‘ä»¬çš„ Ruby è„šæœ¬è¿˜æ˜¯æ— æ³•æ­£ç¡®çš„å¼•ç”¨åˆ°ä»–ä»¬ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œgem åœ¨è‡ªå·±è¢«å®‰è£…åï¼Œå°±å»ä¿®æ”¹äº† Ruby ä¸­ require çš„å®ç°ï¼Œä½¿å¾— require åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œé™¤äº† `$LOAD_PATH`ï¼Œè¿˜ä¼šåœ¨ Gems Install Path ä¸­æŸ¥æ‰¾æ–‡ä»¶ï¼ˆä½ å¯ä»¥é€šè¿‡æ‰§è¡Œ `gem env | grep -A2 'GEM PATHS'` æ‰¾åˆ°ä½ çš„ gem æ‰€å®‰è£…çš„è·¯å¾„ï¼ŒGEMS INSTALL PATH å°±åœ¨è¿™ä¸ªç›®å½•çš„ gems å­ç›®å½•ä¸‹ï¼‰ã€‚

å½“ gem åœ¨ GEMS INSTALL PATH ä¸­æ‰¾åˆ°å¯¹åº”æ–‡ä»¶åï¼Œå°±ä¼šæŠŠè¿™ä¸ªè·¯å¾„åŠ å…¥åˆ° `$LOAD_PATH` ä¸­ï¼Œç„¶åè°ƒç”¨ Ruby æœ¬æ¥çš„ requireã€‚æ­¤æ—¶ç”±äº `$LOAD_PATH` ä¸­å¢åŠ äº†æ–°çš„è·¯å¾„ï¼Œrequire å°±å¯ä»¥æ­£ç¡®çš„åŠ è½½åˆ°ä½ æ‰€å®‰è£…çš„ gem çš„å¯¹åº”æ–‡ä»¶äº†ã€‚

è¿™é‡Œæˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªå°å®éªŒï¼Œæ‰¾ä¸€ä¸ªæ²¡æœ‰ Gemfile çš„ç›®å½•æ‰§è¡Œ irbï¼Œç„¶åä¾æ¬¡è¾“å…¥æ³¨é‡Šä»¥å¤–çš„å†…å®¹ï¼š

```ruby
old_load_path = $LOAD_PATH.dup
require 'cocoapods'
new_load_path = $LOAD_PATH.dup
# æ‰§è¡Œä¸‹é¢çš„ä»£ç å¯ä»¥çœ‹çœ‹ LOAD_PATH æ•°é‡çš„å˜åŒ–
"new: #{new_load_path.count} old: #{old_load_path.count}"
# æ‰§è¡Œä¸‹é¢çš„ä»£ç å¯ä»¥çœ‹çœ‹ LOAD_PATH åˆ°åº•å˜äº†ä»€ä¹ˆã€‚ä½ ä¼šçœ‹åˆ° cocoapods ä»¥åŠä»–çš„ä¾èµ–åº“æ‰€åœ¨çš„ç›®å½•
new_load_path - old_load_path
```

è‡³æ­¤ï¼Œgem å·²ç»å®Œç¾è§£å†³äº†åˆ†å‘ Ruby è„šæœ¬çš„é—®é¢˜ã€‚å½“ä½ æƒ³è¦ä½¿ç”¨ä»»ä½•ä¸€ä¸ªåˆ«äººå·²ç»æä¾›å¥½çš„ gem çš„æ—¶å€™ï¼Œåªéœ€è¦ç®€å•è¾“å…¥ `gem install`ï¼Œä½ çš„è„šæœ¬å°±å¯ä»¥å¿«ä¹çš„ä½¿ç”¨è¿™ä¸ª gem äº†ã€‚

### gem æ‰€å¸¦æ¥çš„æ–°çš„é—®é¢˜

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸€åˆ‡ä¼¼ä¹å¾ˆç¾å¥½ï¼Œä½†æ˜¯éšç€ Ruby åº”ç”¨äºå„ç§å¤§å‹é¡¹ç›®ä»¥åï¼ŒRuby çš„å¼€å‘è€…ä»¬å‘ç°äº†æ–°çš„é—®é¢˜ï¼šå½“ä½ çš„é¡¹ç›®ä¾èµ–äº†åå‡ ä¸ª gem åï¼Œæ–°æ¥æ‰‹çš„äººçš„é…ç½®ç¯å¢ƒæ—¶éœ€è¦è¾“å…¥åå‡ æ¬¡ `gem install` æ‰èƒ½æ­£ç¡®çš„é…ç½®å¥½ç¯å¢ƒã€‚

è¿™æ ·çš„äº‹æƒ…å¼€å‘è€…ä»¬å½“ç„¶ä¸èƒ½å¿ï¼Œäºæ˜¯ä»–ä»¬å¼€å§‹ä½¿ç”¨å„ç§è„šæœ¬æ–‡ä»¶å°†è¿™ä¸ªè¿‡ç¨‹ç®€åŒ–ï¼Œè¿™äº›è„šæœ¬å¯èƒ½å«åš setup.sh ï¼Œä»–ä»¬çš„å†…å®¹ä¸€èˆ¬æ˜¯è¿™æ ·çš„ï¼š

```ruby
gem install foo
gem install bar
```

åœ¨è¿™é‡Œæˆ‘ä»¬æš‚æ—¶å¯ä»¥ç§°å‘¼ç±»ä¼¼è¿™ç§ setup.sh æ–‡ä»¶ä¸º Gem List æ–‡ä»¶ï¼Œå› ä¸ºä»–å°±æ˜¯ä¸€ä¸ªè£…æ»¡äº†æ‰€æœ‰ä½ éœ€è¦å®‰è£…çš„ Gem çš„ List ğŸ¤“ğŸ¤“ğŸ¤“ã€‚

å½“ Ruby çš„å¼€å‘è€…ä»¬è§£å†³äº†æ‰¹é‡å®‰è£… gem çš„é—®é¢˜ä»¥åï¼Œä»–ä»¬åˆå‘ç°äº†æ–°çš„é—®é¢˜ï¼šå¤šç‰ˆæœ¬ç¯å¢ƒä¸éš”ç¦»ã€‚

ä»€ä¹ˆæ„æ€ï¼Ÿæˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚

å‡å¦‚ä½ æ˜¯ä¸€å Ruby å¼€å‘è€…ï¼Œä½ ç»´æŠ¤ç€ä¸€ä¸ªä½ çš„é¡¹ç›® Aï¼Œåœ¨è¿™ä¸ªé¡¹ç›®ä¸­ä½ ä½¿ç”¨äº† 2.0.0 ç‰ˆæœ¬çš„ fooã€‚ä¸€æ®µæ—¶é—´åï¼Œä½ åˆå¼€å§‹æ¥æ‰‹ç»´æŠ¤å¦å¤–ä¸€ä¸ªé¡¹ç›® Bï¼Œä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸ªé¡¹ç›®æœ€å¼€å§‹ä½¿ç”¨çš„ foo çš„ç‰ˆæœ¬æ˜¯ 3.0.0ã€‚äºæ˜¯ä»¤äººå¤´ç–¼çš„äº‹æƒ…å‘ç”Ÿäº†ï¼šå½“ä½ é…ç½®å¥½äº†é¡¹ç›® B çš„ç¯å¢ƒä»¥åï¼Œä½ çš„æœºå™¨ä¸Šå°±ä¼šåŒæ—¶å­˜åœ¨ä¸¤ä¸ªç‰ˆæœ¬çš„ foo çš„ gemã€‚åŒæ—¶ä½ ä¼šå‘ç°ï¼Œä½ çš„é¡¹ç›® A è·‘ä¸èµ·æ¥äº†ï¼Œå› ä¸ºä½ åœ¨è¿è¡Œé¡¹ç›® A æ—¶ï¼Œgem é»˜è®¤ä¼šå»æ‰¾å¤šä¸ªç‰ˆæœ¬ä¸­æœ€æ–°çš„ç‰ˆæœ¬ï¼Œäºæ˜¯åœ¨é¡¹ç›® A ä¸­ä½ ç”¨åˆ°äº† 3.0.0 ç‰ˆæœ¬çš„ foo è€Œä¸æ˜¯ 2.0.0 ç‰ˆæœ¬ã€‚

äºæ˜¯å„ç§æœ‰è¶£ä½†æ— å¥ˆçš„äº‹æƒ…å‘ç”Ÿäº†ï¼šä½ çš„é¡¹ç›®åœ¨ä½ æœ¬åœ°å¯èƒ½å¥½å¥½çš„ï¼Œä½†æ˜¯åœ¨æœåŠ¡å™¨ä¸Šå°±æ˜¯ä¸å¯¹ã€‚ä½ æŸ¥äº†å¥½å‡ å¤©ï¼Œå‘ç°æ˜¯å› ä¸ºæœåŠ¡å™¨ä¸Šçš„å¦å¤–ä¸€ä¸ªé¡¹ç›®è£…äº†ä¸€ä¸ªé«˜ç‰ˆæœ¬çš„ gemï¼Œå¯¼è‡´æœåŠ¡å™¨ä¸Šçš„ç¯å¢ƒæ ¹æœ¬æ²¡æ³•è·‘ä½ çš„é¡¹ç›®ã€‚ä½ ç—›è‹¦ï¼Œä½ ç»æœ›ï¼Œä½†ä½ åˆæ— èƒ½ä¸ºåŠ› ğŸ¤¬ğŸ¤¬ğŸ¤¬ã€‚

å³ä¾¿ä½ åªç»´æŠ¤ä¸€ä¸ªé¡¹ç›®ï¼Œç”±äºä½ çš„ Gem List æ–‡ä»¶ä¸­å¹¶æ²¡æœ‰æŒ‡å®š gem çš„ç‰ˆæœ¬å·ï¼Œæ‰€ä»¥å¾ˆæœ‰å¯èƒ½ä¸€å‘¨å‰åˆ©ç”¨è¿™ä¸ª Gem List æ–‡ä»¶å®‰è£…å‡ºæ¥çš„ gem å’Œä¸€å‘¨åå®‰è£…å‡ºæ¥çš„å®Œå…¨ä¸åŒã€‚ä»¥è‡³äºå¾ˆä¹…ä»¥å‰ Ruby å¼€å‘è€…ä»¬éƒ½ä¼šå¼€ç©ç¬‘ï¼šâ€œä½ å¥½å•Šæ–°äººï¼Œè¿™æ˜¯ä¸€å°æ–°çš„ç”µè„‘ï¼Œæˆ‘ä»¬å¸Œæœ›ä½ èƒ½èŠ±ä¸€å‘¨æŠŠé¡¹ç›®çš„ä¾èµ–é…ç½®å¥½ï¼Œå¦‚æœä¸€åˆ‡é¡ºåˆ©çš„è¯â€

### Bundler çš„è§£å†³æ–¹æ¡ˆ
 
ä¸ºäº†è§£å†³ä¸Šé¢ä½¿ç”¨ gem æ‰€äº§ç”Ÿçš„è¿™äº›é—®é¢˜ï¼ŒBundler æ¨ªç©ºå‡ºä¸–ï¼Œæä¾›ç»™å¼€å‘è€…ä¸¤ä¸ªæ•‘å‘½ä¸€èˆ¬çš„å‘½ä»¤ï¼š

- `bundle install`
- `bundle exec`

`bundle install` ä¸ºæˆ‘ä»¬æä¾›äº†ç»Ÿä¸€å®‰è£…å¤šä¸ª gem çš„ä¾¿æ·æ–¹å¼ã€‚åœ¨æ‰§è¡Œ `bundle install` åï¼ŒBundler ä¼šå°†ä»–æ‰€ä½¿ç”¨çš„ Gem List æ–‡ä»¶ â€”â€” Gemfile ä¸­å£°æ˜çš„ gem å…¨éƒ¨å®‰è£…ï¼ŒåŒæ—¶å°†æ­¤æ¬¡å†³è®®çš„æœ€ç»ˆç‰ˆæœ¬å·ä¿å­˜åœ¨ Gemfile.lock ä¸­ï¼Œä¿è¯ä¸åŒæ—¶åˆ»ä¸åŒæœºå™¨æ‰§è¡Œ `bundle install` èƒ½å¤Ÿå®‰è£…åŒæ ·ç‰ˆæœ¬çš„ gemã€‚

`bundle exec` åˆ™æ›¿æˆ‘ä»¬è§£å†³äº†å¤šç‰ˆæœ¬ç¯å¢ƒä¸éš”ç¦»çš„é—®é¢˜ã€‚å½“ä½ æ‰§è¡Œ `bundle exec` çš„æ—¶å€™ï¼ŒBundler ä¼šæŠŠ `$LOAD_PATH` ä¸­ä¸ç›¸å¹²çš„é‚£äº› gem çš„è·¯å¾„å…¨éƒ½å»æ‰ï¼Œç„¶åè¯»å– Gemfile.lock ä¸­çš„ gem ç‰ˆæœ¬ï¼ˆå¦‚æœæ²¡æœ‰ Gemfile.lock ä¼šå†³è®®ç‰ˆæœ¬ååˆ›å»ºä¸€ä¸ª Gemfile.lockï¼‰ï¼Œä¿è¯ `$LOAD_PATH` ä¸­åªå­˜åœ¨ Gemfile.lock ä¸­å·²ç»å›ºå®šç‰ˆæœ¬çš„ gem çš„è·¯å¾„ã€‚ä½ å¯ä»¥æ‰§è¡Œä¸€ä¸‹ä¸‹é¢ä¸¤è¡Œä»£ç ï¼Œçœ‹çœ‹ `$LOAD_PATH` çš„åŒºåˆ«ï¼š

```ruby
bundle exec ruby -e 'puts $LOAD_PATH'
ruby -e 'puts $LOAD_PATH'
```

### Bundler å¸¦æ¥çš„æ–°é—®é¢˜

è‡³æ­¤ï¼ŒBundler å·²ç»å¾ˆå¥½çš„è§£å†³äº† gem å®‰è£…å’Œç¯å¢ƒéš”ç¦»çš„é—®é¢˜äº†ï¼Œä½†æ˜¯ Bundler ä¹Ÿå¸¦æ¥äº†æ–°çš„éº»çƒ¦ï¼šæ¯æ¬¡æˆ‘ä»¬æ‰§è¡Œ Ruby ç›¸å…³çš„å‘½ä»¤ä¹‹å‰éƒ½è¦é‡å¤çš„è¾“å…¥ `bundle exec` ğŸ¤¦ğŸ»â€â™‚ï¸ğŸ¤¦ğŸ»â€â™‚ï¸ğŸ¤¦ğŸ»â€â™‚ï¸ã€‚

è¿˜å¥½ Ruby çš„å¼€å‘è€…ä»¬éƒ½å¾ˆæ‡’ï¼Œä»–ä»¬å¼€å‘äº†ä¸€ä¸ªæ–°çš„ gem â€”â€” [rubygems-Bundler](https://github.com/rvm/rubygems-Bundler) æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å½“ä½ å®‰è£…è¿™ä¸ª gem ä»¥åï¼Œåªè¦æ‰§è¡Œä¸€æ¬¡ `gem regenerate_binstubs`ï¼Œrubygems-Bundler å°±ä¼šå¸®ä½ åœ¨ä»»ä½• gem å®‰è£…çš„å‘½ä»¤è¡Œæ‰§è¡Œä¹‹å‰æ£€æŸ¥ä¸€ä¸‹å½“å‰ç›®å½•ä»¥åŠçˆ¶ç›®å½•æ˜¯å¦å­˜åœ¨ Gemfileã€‚å¦‚æœå­˜åœ¨ï¼Œå°±è‡ªåŠ¨å¸®ä½ çš„å‘½ä»¤è¡Œä¹‹å‰åŠ ä¸Š `bundle exec` å†æ‰§è¡Œã€‚å®Œç¾çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚

> å°æç¤ºï¼š1.11.0 ä»¥ä¸Šç‰ˆæœ¬çš„ RVM åœ¨å®‰è£… Ruby æ—¶ï¼Œé»˜è®¤ä¼šå®‰è£… rubygems-Bundlerã€‚ä½ å¯ä»¥é€šè¿‡ `gem list rubygems-Bundler` æ¥æ£€æŸ¥è‡ªå·±æ˜¯å¦å®‰è£…äº†è¿™ä¸ª gemã€‚å¦‚æœä½ ç”¨ homebrew å®‰è£… Rubyï¼Œåˆ™ä¸ä¼šäº«å—åˆ°è¿™ä¸ªéšè—çš„ç¦åˆ©ã€‚

## æ‰©å±•ç»ƒä¹ ï¼šæ¥çœ‹çœ‹ä¸€äº›å¸¸è§çš„æŠ¥é”™ï¼Œç°åœ¨ä½ çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆäº†ä¹ˆï¼Ÿ

### ç»ƒä¹ ä¸€

```
LoadError - cannot load such file -- macho
```

### ç»ƒä¹ äºŒ

```
Could not find proper version of cocoapods (1.1.1) in any of the sources
Run `bundle install` to install missing gems.
```

### ç»ƒä¹ ä¸‰

```
Required ruby-2.3.7 is not installed.
To install do: 'rvm install "ruby-2.3.7"'
```

## å‚è€ƒ

- [Rbenv â€” How it works](https://medium.com/@Sudhagar/rbenv-how-it-works-e5a0e4fa6e76)
- [rbenv vs rvm](http://www.mindfiresolutions.com/blog/2018/01/rbenv-vs-rvm/)
- [A Ruby workflow with RVM and Bundler](https://afterthoughtsoftware.com/posts/A-Ruby-workflow-with-RVM)
- [Bundler: The best way to manage a Ruby application's gems](https://Bundler.io/rationale.html)
- [How Bundler Works: A History of Ruby Dependency Management](https://www.cloudcity.io/blog/2015/07/10/how-Bundler-works-a-history-of-ruby-dependency-management/)
- [A History of Bundles: 2010 to 2017](https://andre.arko.net/2017/11/16/a-history-of-bundles/)
- [Understanding ruby load, require, gems, Bundler and rails autoloading from the bottom up](https://medium.com/@connorstack/understanding-ruby-load-require-gems-Bundler-and-rails-autoloading-from-the-bottom-up-3b422902ca0)
- [How does Bundler work, anyway?](https://andre.arko.net/2015/04/28/how-does-Bundler-work-anyway/)
