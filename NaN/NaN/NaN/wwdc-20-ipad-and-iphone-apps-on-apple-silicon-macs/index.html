<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>WWDC20-10114-iPad and iPhone apps on Apple Silicon Macs | Onee&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/icon.png">
    <link rel="alternate" type="application/rss+xml" href="https://onee.me/rss.xml" title="Onee&#39;s Blog RSS Feed">
    <meta name="description" content="今年 WWDC 最为重磅的消息可能就是 Apple Silicon Mac——搭载着苹果自研芯片的 Mac。得益于 CPU 架构的统一，在 Mac上原生的运行 iPhone 或者 iPad App 似乎已经不是那么的遥不可及了。相信很多人都会好奇苹果将会用什么样的方式将这些移动设备上的 App 带到我们手中的 Mac 上。[Session 10114 iPad and iPhone apps on ...">
    
    <link rel="preload" href="/assets/css/0.styles.e072e671.css" as="style"><link rel="preload" href="/assets/js/app.9cbc85f0.js" as="script"><link rel="preload" href="/assets/js/8.de39a2df.js" as="script"><link rel="preload" href="/assets/js/4.75a239aa.js" as="script"><link rel="preload" href="/assets/js/23.5151b5c1.js" as="script"><link rel="preload" href="/assets/js/11.1ced6ab3.js" as="script"><link rel="prefetch" href="/assets/js/10.0499a691.js"><link rel="prefetch" href="/assets/js/12.8dbd30c2.js"><link rel="prefetch" href="/assets/js/13.347dbc79.js"><link rel="prefetch" href="/assets/js/14.2adb8fa7.js"><link rel="prefetch" href="/assets/js/15.61edbf17.js"><link rel="prefetch" href="/assets/js/16.f6fb6f07.js"><link rel="prefetch" href="/assets/js/17.2624cae3.js"><link rel="prefetch" href="/assets/js/18.caae516a.js"><link rel="prefetch" href="/assets/js/19.74468e7f.js"><link rel="prefetch" href="/assets/js/20.db96440f.js"><link rel="prefetch" href="/assets/js/21.d6e772b1.js"><link rel="prefetch" href="/assets/js/22.aa0557ab.js"><link rel="prefetch" href="/assets/js/24.9f10956c.js"><link rel="prefetch" href="/assets/js/25.6555ae13.js"><link rel="prefetch" href="/assets/js/26.035b50f9.js"><link rel="prefetch" href="/assets/js/27.fec80cb8.js"><link rel="prefetch" href="/assets/js/3.a2e370df.js"><link rel="prefetch" href="/assets/js/5.8922c4b3.js"><link rel="prefetch" href="/assets/js/6.4dc5f0a5.js"><link rel="prefetch" href="/assets/js/7.72183347.js"><link rel="prefetch" href="/assets/js/9.4ce6e40a.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.496722bb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e072e671.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">Onee's Blog </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">Timeline</a></li><li class="nav-item"><a href="/skill/" class="nav-link">Skill</a></li><li class="nav-item"><a href="/about/" class="nav-link">About</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <a href="/rss.xml" class="feed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">Onee's Blog </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">Timeline</a></li><li class="mobile-nav-item"><a href="/skill/" class="nav-link">Skill</a></li><li class="mobile-nav-item"><a href="/about/" class="nav-link">About</a></li> <li class="mobile-nav-item"><a href="/rss.xml" class="feed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        WWDC20-10114-iPad and iPhone apps on Apple Silicon Macs
      </h1> <div class="post-meta"><!----> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2020/07/12">
      2020-07-12
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/tag/青铜" data-v-42ccfcd5><span data-v-42ccfcd5>青铜</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/tag/Computer-Platform-iOS-Silicon" data-v-42ccfcd5><span data-v-42ccfcd5>Computer-Platform-iOS-Silicon</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><p>今年 WWDC 最为重磅的消息可能就是 Apple Silicon Mac——搭载着苹果自研芯片的 Mac。得益于 CPU 架构的统一，在 Mac上原生的运行 iPhone 或者 iPad App 似乎已经不是那么的遥不可及了。相信很多人都会好奇苹果将会用什么样的方式将这些移动设备上的 App 带到我们手中的 Mac 上。<a href="https://developer.apple.com/videos/play/wwdc2020/10114/" target="_blank" rel="noopener noreferrer">Session 10114 iPad and iPhone apps on Apple Silicon Macs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 就是对这些疑问的一个统一回答。</p> <h2 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h2> <p>简单来说，Session 10114 主要向我们传达了这几个信息：</p> <ul><li>运行方面：在不依赖 macOS 系统没有的 SDK 的前提下，所有的 iPhone/iPad App 在 Apple Silicon Mac 上都可以无需改动运行起来，只是很多地方看起来会不那么符合 macOS 风格，结合 Catalyst 会让我们的 App 在 macOS 上更好用</li> <li>调试方面：调试运行在 Mac 上的 iPhone/iPad 的过程和在模拟器、真机上完全相同</li> <li>发布方面：默认所有的 iPhone/iPad App 都可以发布到 Mac App Store，开发者可以选择手动关闭，同时像 Ad Hoc 或者企业分发这种 App Store 外的发布流程也和之前基本相同</li></ul> <p>接下来，我们来详细了解一下苹果的工程师都说了什么。</p> <h2 id="运行"><a href="#运行" class="header-anchor">#</a> 运行</h2> <p>在有 Apple Silicon Mac 之前，在 macOS 上我们一般会开发这四种类型的应用程序：</p> <ul><li>Mac apps： 基于 AppKit 开发，比较老牌的一种开发方式</li> <li>Mac Catalyst apps：在 macOS Catalina 后才支持的开发方式，基于 UIKIt 开发</li> <li>Web Apps：基于前端技术栈开发，比较老牌的一种开发方式</li> <li>Games：基于 Metal 框架开发，相对比较新的一种开发方式</li></ul> <p><img src="/assets/images/2020-07-12-wwdc-20-ipad-and-iphone-apps-on-apple-silicon-macs/image-20200712205637358.png" alt="image-20200712205637358"></p> <p>得益于 Catalyst 在 macOS 上引入的 UIKit，在 Apple Silicon Mac 上，我们可以非常轻松的运行原本运行在 iPhone/iPad 上的 App。</p> <p><img src="/assets/images/2020-07-12-wwdc-20-ipad-and-iphone-apps-on-apple-silicon-macs/image-20200712210101406.png" alt="image-20200712210101406"></p> <p>默认运行起来的这些 App 在很多方面上都可以获得类似 macOS App 的体验，包括：</p> <ul><li>Standard window chrome（就是 Mac app 左上角的那三个按钮）</li> <li>Menu bar</li> <li>macOS app lifecycle</li> <li>Preferences panel</li> <li>Dock presence</li> <li>Dark Mode</li> <li>Open/save panels（CMD + O / CMD + S会打开的那个面板）</li> <li>Text behaviors</li> <li>Font and color panels</li> <li>Scroll bars</li> <li>Touch Bar</li> <li>Printing</li> <li>Alerts</li> <li>Drag and drop（和 iOS 上的类似，通过拖拽将一个 App 中的内容移动到另一个 App 中，参见 <a href="https://developer.apple.com/design/human-interface-guidelines/macos/user-interaction/drag-and-drop/" target="_blank" rel="noopener noreferrer">Human Interface Guidelines - Drag and Drop<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</li></ul> <blockquote><p>注意：</p> <p>尽管以上这些内容是可以自动获得的，但仅仅有这些能力并不足以让一个 App 在 macOS 获得良好的体验，这些 App 仅仅是处于 “能用” 的状态。如果想要让 App 在 macOS 上“好用”，苹果的工程师建议我们使用 Catalyst 来优化 App 的体验。</p></blockquote> <p>不过获得以上这些体验的前提是，App 能够在 macOS 上正常的运行起来。</p> <p>要想让 App 能够在 macOS 上正常的运行起来，开发者需要关注这几个方面的事情：</p> <ul><li>App 没有依赖 macOS 上不存在的 API 或者是 SDK（包括系统的和第三方库的）</li> <li>App 没有依赖 macOS 缺失的功能</li> <li>App 没有依赖 Mac 所不具有的硬件能力</li></ul> <p>除此之外，在代码的健壮性上，开发者需要关注 iPhone/iPad App 在 Mac 上运行会有如下方面的不同：</p> <ul><li>硬件上的不同</li> <li>UI 上的不同</li> <li>系统软件上的不同</li></ul> <h3 id="硬件上的不同"><a href="#硬件上的不同" class="header-anchor">#</a> 硬件上的不同</h3> <p>硬件方面，苹果的工程师主要提及了三点不同：</p> <ul><li>鼠标与触摸事件的不同</li> <li>环境传感器的不同</li> <li>摄像头的不同</li></ul> <h4 id="鼠标与触摸事件的不同"><a href="#鼠标与触摸事件的不同" class="header-anchor">#</a> 鼠标与触摸事件的不同</h4> <p>在 iPhone/iPad 上用户输入都是以触摸为主，而 Mac 则是以鼠标键盘为主。macOS 会尽量将普通的点击等事件映射成对应的触摸事件。但如果 App 实现了一些自定义的触摸事件，那么开发者就需要自己测试一下自己的 App 在 Apple Silicon Mac 上是否表现正常。</p> <h4 id="环境传感器的不同"><a href="#环境传感器的不同" class="header-anchor">#</a> 环境传感器的不同</h4> <p>iPhone/iPad 上都有着大量的环境传感器，例如加速剂、陀螺仪、GPS、磁力计、景深摄像头等，而在 Mac 上基本没有这些传感器。因此开发者要在代码做好没有这些传感器的对应处理。需要注意的是，没有传感器并不代表没有相应能力，例如在 Mac 上开发者依旧可以使用 CoreLocation 来获取设备当前的位置（只是不那么精确）。</p> <h4 id="摄像头的不同"><a href="#摄像头的不同" class="header-anchor">#</a> 摄像头的不同</h4> <p>在 iPhone/iPad 上几乎所有的设备都拥有前置和后置摄像头，但是在 Mac 上这种假设并不一定成立。苹果的工程师建议开发者，用 <a href="https://developer.apple.com/documentation/avfoundation/avcapturedevice/discoverysession" target="_blank" rel="noopener noreferrer">AVCaptureDevice.DiscoverySession<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 这个 API 来获取摄像头设备的使用权限。</p> <h3 id="ui-上的不同"><a href="#ui-上的不同" class="header-anchor">#</a> UI 上的不同</h3> <p>在 macOS 中，很多系统控件的行为表现会和 iPhone/iPad 上不太一样，例如 Alert：</p> <p><img src="/assets/images/2020-07-12-wwdc-20-ipad-and-iphone-apps-on-apple-silicon-macs/image-20200712213344387.png" alt="image-20200712213344387"></p> <p>所以 App 的代码中不要有任何类似假定系统控件弹出位置的代码，因为这些代码运行在 Mac 上时，会得到完全不同的结果。</p> <p>同时注意，如果开发者的 iPad App 没有支持 <a href="https://developer.apple.com/design/human-interface-guidelines/ios/system-capabilities/multitasking/" target="_blank" rel="noopener noreferrer">Multitasking<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，会和 iPhone App 一样在 Apple Silicon Mac 上表现为一个不可以改变大小的窗口。</p> <p>如果 iPad App 支持了 Multitasking，那么开发者需要保证布局代码足够的高效，以便用户在缩放窗口大小时能够得到流畅的体验。</p> <h3 id="系统软件上的不同"><a href="#系统软件上的不同" class="header-anchor">#</a> 系统软件上的不同</h3> <p>系统软件上的不同主要体现在两个方面：</p> <ul><li>文件系统</li> <li>设备信息</li></ul> <h4 id="文件系统"><a href="#文件系统" class="header-anchor">#</a> 文件系统</h4> <p>和 iPhone/iPad App 不同，Mac App 可能被用户放置在任何一个地方，因此 App 的代码中不应该对 App Bundle 以及沙盒的位置做任何硬编码。</p> <h4 id="设备信息"><a href="#设备信息" class="header-anchor">#</a> 设备信息</h4> <p>在 Mac 上，窗口的分辨率可能会有各种各样的变化，设备名称也可能有各种各样的变化，因此 App 内部不应该对设备的分辨率以及设备名称做任何假设（设备名称这一条 App 对应的后端服务也要注意，不要依赖设备名称）</p> <h2 id="调试"><a href="#调试" class="header-anchor">#</a> 调试</h2> <p>调试这部分可以讲述的东西不多，因为整体内容就可以用四个字来总结：完 全 一 致。不管是 Debug 的工作流，还是 Profile 的工作流，甚至单元测试的工作流都是完全一样的。</p> <p>唯一值得一提的是，根据苹果工程师的说法，在 Apple Silicon Mac 上，使用 Xcode 打开 iOS 工程，在 Target 的 Destination Device 中会多一个 My Mac(Designed for iPad) 这样一个设备：</p> <p><img src="/assets/images/2020-07-12-wwdc-20-ipad-and-iphone-apps-on-apple-silicon-macs/image-20200712215659004.png" alt="image-20200712215659004"></p> <p>选择这个设备，运行起来后就会看到这样的效果——没有模拟器，直接运行在 Mac 上的 iOS App：</p> <p><img src="/assets/images/2020-07-12-wwdc-20-ipad-and-iphone-apps-on-apple-silicon-macs/image-20200712220053235.png" alt="image-20200712220053235"></p> <h2 id="发布"><a href="#发布" class="header-anchor">#</a> 发布</h2> <p>如果说调试可以用四个字来形容，那么发布就可以用六个字来形容：基 本 完 全 一 致。</p> <p>将 iPhone/iPad App 发布到 Mac App Store 的步骤和发布到 iOS App Store 的步骤是基本一致的，开发者需要做的就是同意新的开发者协议，然后把能够发布到 Mac 上的 App 勾选发布到 Mac 即可，整个过程就像是发布到一个新的设备类型一样。</p> <p><img src="/assets/images/2020-07-12-wwdc-20-ipad-and-iphone-apps-on-apple-silicon-macs/image-20200712221130312.png" alt="image-20200712221130312"></p> <p>通过这种方式发布的 App 同样也可以使用 StoreKit 完成应用内购买、AppThing 以及 On-demand Resources 这些 iOS App Store 提供的功能，唯一有所区别的是，TestFlight 并不支持这种形式的 App。</p> <p>同样的过程也体现在 Ad Hoc/Enterpirse/Development 发布的过程中，整个过程中开发者只要将 Mac 当做一个新的设备类型发布即可。</p> <p>除此之外，在今年的晚些时候（熟悉的 Later in Summer），苹果还会提供一些新的开发者工具，帮助开发者更好的验证他们的 App 在 Apple Silicon Mac 上的表现。</p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>虽然形式非常不同，但是苹果 Catalyst + Apple Silicon Mac 的这套组合拳，让我不禁联想到了 IPad 早年推出的时可以运行 iPhone App 的操作。以成熟的生态带动一个不那么成熟的生态，进而创建/拉动一个新的生态。虽然现在只是一个开始，但说不定过几年再看我们会发现：</p> <p><img src="/assets/images/2020-07-12-wwdc-20-ipad-and-iphone-apps-on-apple-silicon-macs/image-20200712222100729.png" alt="image-20200712222100729"></p></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#概述" title="概述">概述</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#运行" title="运行">运行</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#硬件上的不同" title="硬件上的不同">硬件上的不同</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#ui-上的不同" title="UI 上的不同">UI 上的不同</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#系统软件上的不同" title="系统软件上的不同">系统软件上的不同</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#调试" title="调试">调试</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#发布" title="发布">发布</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#总结" title="总结">总结</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8></ul></div></footer></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.9cbc85f0.js" defer></script><script src="/assets/js/8.de39a2df.js" defer></script><script src="/assets/js/4.75a239aa.js" defer></script><script src="/assets/js/23.5151b5c1.js" defer></script><script src="/assets/js/11.1ced6ab3.js" defer></script>
  </body>
</html>
